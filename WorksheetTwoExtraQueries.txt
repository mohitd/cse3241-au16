Give the number of books purchased using a particular type of credit card (i.e. Mastercard, Visa)


    typeùìïCOUNT(cc)(œÄcc(PAYMENT * (PURCHASES *  CUSTOMER_PAY_INFO)))

    SELECT Count(*) FROM PaymentInfo pay, Purchase pur, CustomerPaymentInfo cpi
WHERE pur.CustomerID=cpi.CustomerID and pay.CreditCardID=cpi.CreditCardID
and pay.Type='Discover'


Give the price of all books that are used as textbooks for all courses at a university (unid = EWKLEDVFBX)


    œÄprice(œÉunid=6025(COURSE ‚ãàrequired_book=isbn BOOK))

    SELECT price FROM Course c JOIN Book b ON c.RequiredBook=b.Isbn WHERE c.UniversityID="EWKLEDVFBX"


Get the emails of all customers whose credit card is going to expire before the end of 2016.


    œÄemail(œÉexp_date < ‚Äò2016-12-31‚Äô‚Äô(PAYMENT * (CUSTOMER_PAY_INFO * CUSTOMER)))
    
    SELECT Email FROM PaymentInfo pay, Customer c, CustomerPaymentInfo cpi 
WHERE c.CustomerID=cpi.CustomerID AND pay.CreditCardID=cpi.CreditCardID 
AND date('20'+substr(pay.ExpirationDate, 4)+'-'+substr(pay.ExpirationDate, 1, 3) + '31') < date('2016-12-31')
